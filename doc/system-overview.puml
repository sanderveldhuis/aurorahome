@startuml
!include <C4/C4_Container.puml>

title AuroraHome system overview

Person_Ext(User, "AuroraHome User", "Desktop/Mobile browser")
System_Ext(OpenWeatherMap, "OpenWeatherMap", "")

System_Boundary(Frontend, "Frontend") {
  System(StatusWidget, "StatusWidget", "")
  System(ConfigWidget, "ConfigWidget", "")
  System(WeatherWidget, "WeatherWidget", "")
}

System_Boundary(Backend, "Backend") {
  ContainerDb(MongoDb, "MongoDB", "")

  System_Boundary(Api, "API") {
    System(StatusApi, "/api/status", "")
    System(ConfigApi, "/api/config", "")
    System(WeatherApi, "/api/weather", "")
  }

  System_Boundary(Workers, "Workers") {
    System(StatusManager, "StatusManager", "")
    System(ConfigManager, "ConfigManager", "")
    System(WeatherManager, "WeatherManager", "")
  }
}

Rel_D(User, Api, "HTTPS", "GET/POST/PUT/DELETE")
Rel_D(User, Frontend, "HTTPS", "GET")
Rel_D(StatusWidget, StatusApi, "HTTPS", "GET")
Rel_D(ConfigWidget, ConfigApi, "HTTPS", "GET/POST")
Rel_D(WeatherWidget, WeatherApi, "HTTPS", "GET")
Rel_D(WeatherApi, WeatherManager, "IPC pub/sub", "WeatherManagerData")
Rel_D(ConfigApi, ConfigManager, "IPC req/res", "SetConfig")
Rel_D(ConfigManager, WeatherManager, "IPC pub/sub", "WeatherManagerConfig")
Rel_R(ConfigManager, MongoDb, "read/write")
Rel_R(WeatherManager, OpenWeatherMap, "HTTPS", "GET")
Rel_D(ConfigManager, StatusManager, "IPC ind", "ConfigManagerStatus")
Rel_D(WeatherManager, StatusManager, "IPC ind", "WeatherManagerStatus")

@enduml
